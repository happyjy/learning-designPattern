<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>

  <script>

    /*

      # [ ] 추가 기능 구현 해보기 
        * 초기화 이전 값
        * 지금 값 임시 저장 해놓기 등 
    */

    function add(x, y) { return x + y; }
    function sub(x, y) { return x - y; }
    function mul(x, y) { return x * y; }
    function div(x, y) { return x / y; }

    var Command = function (execute, undo, value) {
      this.execute = execute;
      this.undo = undo;
      this.value = value;
    }

    var AddCommand = function (value) {
      return new Command(add, sub, value);
    };
    var SubCommand = function (value) {
      return new Command(sub, add, value);
    };
    var MulCommand = function (value) {
      return new Command(mul, div, value);
    };
    var DivCommand = function (value) {
      return new Command(div, mul, value);
    };


    var Calculator = function () {
      // current: 계산 할 값에 대한 value
      // command: execute시 수행한 연산 stack으로 보관
      var current = 0;
      var command = [];

      function action(command) {
        var name = command.execute(current, command.value);
        return name.charAt(0).toUpperCase() + name.slice(1);
      }

      // [ ] 여러 객체를 만들지 않을 거라서 prototype에 선언을 하지 않은건가? 
      return {
        execute: function (command) {
          current = command.execute(current, command.value);
          commands.push(command);
          log.add(action(command) + ": " + command.value);
        },

        undo: function () {
          var command = commands.pop();
          current = current.undo(current, command.value);
          log.add("Undo " + action(command) + ": " + command.value);
        },

        getCurrentValue: function () {

        }
      }
    }

    var log = (function () {
      var log = '';
      return {
        add: function (msg) { log += msg + '\n' },
        show: function () { console.log(log); log = ''; },
      }

    })()
    function run() {
      var calculator = new Calculator();

      // issue commands
      calculator.execute(new AddCommand(100));
      calculator.execute(new SubCommand(24));
      calculator.execute(new MulCommand(6));
      calculator.execute(new DivCommand(2));

      //reverse last two commands
      calculator.undo();
      log.add('\n Value: ' + calculator.getCurrentValue());
      log.show();

      console.log("---");

      calculator.undo();
      log.add('\n Value: ' + calculator.getCurrentValue());
      log.show();


    }
  </script>

</body>

</html>